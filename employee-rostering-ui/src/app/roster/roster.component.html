<div class="container">
  <h1 class="text-center">Employee Rostering</h1>
  <div class="row">
    <div>
      <form (submit)="onSubmit()">
        <div class="row">
          <div class="form-group col-6">
            <label for="employeeFile">Upload Employees.json File</label>
            <input type="file" id="employeeFile" (change)="onFileSelected($event, 'employees')" accept=".json"/>
          </div>
          <div class="form-group col-4">
            <label for="shiftFile">Upload Shifts.json File</label>
            <input type="file" id="shiftFile" (change)="onFileSelected($event, 'shifts')" accept=".json"/>
          </div>
          <button type="submit" class="btn btn-primary col-2">Submit</button>
        </div>
      </form>
    </div>

    <div >
      <button (click)="getSolveRoster()" class="btn btn-primary">Get Roster</button>
      <button (click)="terminateSolveRoster()" class="btn btn-primary m-3">Terminate Roster</button>
      <div>
        {{message}}
      </div>
      <div *ngIf="roster.shiftAssignmentList">
        <h2>Generated Roster</h2>
        <table class="table table-bordered">
          <tr>
            <th>Id</th>
            <th>Skills</th>
            <th>Days</th>
            <th>Start Time</th>
            <th>End Time</th>
            <th>Employee Required</th>
            <th>Employee</th>
          </tr>
          <tr *ngFor="let assignment of roster.shiftAssignmentList">
            <td>{{assignment.id}}</td>
            <td>{{assignment.shift.skills}}</td>
            <td>{{assignment.shift.days}}</td>
            <td>{{assignment.shift.startTime}}</td>
            <td>{{assignment.shift.endTime}}</td>
            <td>{{assignment.shift.employee_required}}</td>
            <td colspan="2">
              <table class="table-bordered inner-table" style="width: 100%;">
                <tr>
                  <th>Name</th>
                  <th>Skills</th>
                  <th>Start time -- End Time</th>
                </tr>
                <tr *ngFor="let employee of assignment.employee">
                  <td>{{employee.name}}</td>
                  <td>{{employee.skills}}</td>
                  <td>
                    <p *ngFor="let availabilities of employee.availabilities">
                      {{availabilities.startTime}} -- {{availabilities.endTime}}
                    </p>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </div>
      <div class="row">
        <div class="col-6">
          <h2>Score</h2>
          <li>initScore : {{roster.score?.initScore}}</li>
          <li>hardScore : {{roster.score?.hardScore}}</li>
          <li>softScore : {{roster.score?.softScore}}</li>
          <li>feasible : {{roster.score?.feasible}}</li>
          <li>solutionInitialized : {{roster.score?.solutionInitialized}}</li>
          <li>zero : {{roster.score?.zero}}</li>
        </div>
        <div class="col-6">
            <h1>Score Explanation</h1>
            <div *ngIf="scoreExplanation">
              <p>Score: {{ scoreExplanation.score }}</p>
              <div *ngFor="let constraint of scoreExplanation.constraintMatchTotals">
                <h3>constraintName : {{ constraint.constraintName }}</h3>
                <p>Score: {{ constraint.score }}</p>
                <ul>
                  <li *ngFor="let match of constraint.constraintMatches">
                    <b>Justification:</b> {{ match.justification }}
                    <ol><b>Score:</b> {{ match.score }}</ol>
                  </li>
                </ul>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
